<script>
  // https://stackoverflow.com/a/72292354

  function updateProgress({ progress, complete }) {
    const student = document.getElementById('student');
    try {
      Object.assign(document.getElementById('progress'), progress);
      student.innerHTML = `${progress.current} (${progress.value} / ${
        progress.max
      })<br/>${progress.progress || 'Workingâ€¦'}`;
    } catch (e) {
      console.error(e.message);
    }
    if (!complete) {
      getUpdatedProgress();
    } else {
      google.script.host.close();
    }
  }

  function getUpdatedProgress() {
    google.script.run
      .withSuccessHandler(updateProgress)
      .helper_createAll_getProgress();
  }

  getUpdatedProgress();
</script>
