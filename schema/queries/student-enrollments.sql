select dub1.grad_year as [Grad Year] , dub1.preferred_or_first_name as [First name] , dub1.lastname as [Last Name] , dub1.host_id as [Host ID] , dub1.email as [E-Mail] , dat1.school_year as [School Year] , dat1.term_description as [Term Description] , dcb1.course_title as [Course Title] , dcb1.course_code as [Course Code] , dag1.group_identifier as [Group Identifier] , dat1.term_name as [Term name] , dcb1.course_length as [Course Length] , aca1.department as [Department] , ce1.enrolled as [Enrolled] , ce1.dropped as [Dropped] , ce1.changed_sections as [Changed Sections] , dat1.end_date as [End Date] , grecr1.credits_attempted as [Credits attempted] , grecr1.credits_earned as [Credits Earned] from
dbo.da_academic_group(@p1)dag1 INNER JOIN dbo.da_course_base(@p1)dcb1 ON dcb1.course_id = dag1.course_id INNER JOIN dbo.da_course_department(@p1)cd1 ON cd1.course_id = dcb1.course_id INNER JOIN dbo.da_academic_department(@p1)aca1 ON aca1.department_id = cd1.department_id INNER JOIN dbo.da_academic_enrollment(@p1)ce1 ON ce1.group_id = dag1.group_id INNER JOIN dbo.da_user_base(@p1)dub1 ON dub1.user_id = ce1.student_user_id INNER JOIN dbo.da_user_role(@p1)dur1 ON dur1.user_id = dub1.user_id LEFT OUTER JOIN dbo.da_enrollment_grade(@p1)grecg1 ON grecg1.group_id = ce1.group_id AND grecg1.student_user_id = ce1.student_user_id LEFT OUTER JOIN dbo.da_enrollment_credit(@p1)grecr1 ON grecr1.group_id = ce1.group_id AND grecr1.student_user_id = ce1.student_user_id INNER JOIN dbo.da_academic_term(@p1)dat1 ON dat1.term_id = dag1.term_id
where dur1.role IN (select [value] from dbo.fn_convertlisttosetstr('Student',',')) And dcb1.course_code NOT LIKE '0%' And aca1.department <> 'Music Lessons' And aca1.department <> 'GRACE'
group by dub1.grad_year , dub1.preferred_or_first_name , dub1.lastname , dub1.host_id , dub1.email , dat1.school_year , dat1.term_description , dcb1.course_title , dcb1.course_code , dag1.group_identifier , dat1.term_name , dcb1.course_length , aca1.department , ce1.enrolled , ce1.dropped , ce1.changed_sections , dat1.end_date , grecr1.credits_attempted , grecr1.credits_earned
